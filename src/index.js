
const listCnpj =[
// "5700405001390",
// "90799396000171",
// "436491000118",
// "5232737000153",
// "9564091000677",
// "92762343000292",
// "9149277000902",
// "20958896000123",
// "22301742000190",
// "22301742000432",
// "22301742000351",
// "22301742000513",
// "27460934000243",
// "22301742000785",
// "40125248000101",
// "39903492000160",
// "24681431000129",
// "30470088000176",
// "24681431000471",
// "21507483000195",
// "44296165000128",
// "6338211000115",
// "35951074000198",
// "10541625000114",
// "39955087000196",
// "48805066000185",
// "23025677000180",
// "90981366000181",
// "44738608000193",
// "90799396000333",
"12668658000155",
"22867655000102",
"46494671000157",
"6065831000390",
"13641798000100",
"22836553000111",
"4918617000494",
"41538955000184",
"93697639000159",
"12004308000194",
"17876885000190",
"24721705000166",
"29231020000236",
"40424535000104",
"4378625000142",
"30998254013513",
"20962801000145",
"48321416000138",
"16572402000109",
"12453747000184",
"13562299000110",
"14685954000190",
"31837959000100",
"12870401000181",
"41930930000121",
"22682158000121",
"10483393000195",
"3607817000110",
"33444513000140",
"35155715000106",
"34209840000180",
"4898933000107",
"44379017000177",
"11146660000100",
"8680461000164",
"41975816000118",
"31290663000111",
"3269921000142",
"30998254011065",
"9163828000135",
"6983297000139",
"32870130000171",
"32201073000138",
"34713694000126",
"36016669000119",
"33600031000132",
"26429218000150",
"92686088000165",
"16692115000124",
"8954068000111",
"97053409000108",
"22902537000180",
"40836533000122",
"1147960000141",
"35205983000187",
"35826345000183",
"36357717000132",
"18198912000428",
"18029647000101",
"5746878000194",
"13712775000131",
"42252690000116",
"3965053000135",
"22321828000184",
"23498260000134",
"28261459000168",
"7001788000108",
"10346361000148",
"22779174000137",
"93564854000181",
"21853255000177",
"49162763000128",
"50379727000108",
"4661235000185",
"47827716000120",
"35720974000124",
"8904038000109",
"32110984000150",
"5266707000168",
"27381562000189",
"92579747000164",
"10843036000190",
"37442441000153",
"32596978000154",
"47788374000187",
"47773073000180",
"24474273000136",
"44017329000130",
// "28960872000110",
// "46366034000103",
// "7346099000127",
// "7806229000167",
// "93693190000150",
// "11844291000110",
// "46494707000100",
// "8929395000113",
// "94747722000158",
// "41584304000120",
// "46145717000122",
// "39504570000154",
// "31453025000174",
// "24717421000104",
// "44911129000127",
// "16796317000116",
// "32372150000112",
// "33377701000101",
// "44161264000100",
// "30425405000132",
// "29054971000104",
// "44688003000135",
// "2334061000110",
// "9232173000100",
// "15790030000116",
// "28816380000156",
// "21549201000112",
// "15166991000154",
// "40938386000100",
// "350356000155",
// "36419561000177",
// "33230282000172",
// "7491297000184",
// "7478390000159",
// "32868965000197",
// "92570530000193",
// "7507712000140",
// "11400539000154",
// "97052641000121",
// "5534838000189",
// "46518425000198",
// "48929860000130",
// "29903398000158",
// "5360500000158",
// "8769595000318",
// "23350126000191",
// "36297897000104",
// "39566100000115",
// "42947797000189",
// "4088443000137",
// "5002152000147",
// "929375000130",
// "37760706000161",
// "7402070000115",
// "399508000104",
// "582651000137",
// "664071000199",
// "852733000154",
// "865028000191",
// "1254300000160",
// "1275768000130",
// "1579286000174",
// "2044669000100",
// "2274472000168",
// "2435669000131",
// "2527089000174",
// "2576753000175",
// "2578798000189",
// "2743376000111",
// "2996445000107",
// "3069326000163",
// "3220371000177",
// "3286546000149",
// "3368710000167",
// "3475676000120",
// "3582016000148",
// "3678769000151",
// "3830410000158",
// "3893980000197",
// "4064508000104",
// "4111939000184",
"4344199000126"]
// "4349294000112",
// "4443612000100",
// "4489349000190",
// "4617336000159",
// "4654929000195",
// "4738692000120",
// "4754118000166",
// "4827421000141",
// "4963094000155",
// "5072763000161",
// "5096536000176",
// "5148000000157",
// "5324036000144",
// "5330424000138",
// "5430599000117",
// "5563865000180",
// "5566068000156",
// "5579246000183",
// "5727457000116",
// "5764999000169",
// "5926552000149",
// "6020977000157",
// "7097916000150",
// "7279155000158",
// "7334237000158",
// "7420453000116",
// "7445352000108",
// "7480818000106",
// "7636818000144",
// "7648019000198",
// "7650319000101",
// "7916808000162",
// "8004521000200",
// "8056896000132",
// "8212671000128",
// "8308907000124",
// "8512905000152",
// "8513762000101",
// "8628126000117",
// "8675099000133",
// "8688853000170",
// "8768465000107",
// "8804263000165",
// "8812445000188",
// "8911337000162",
// "8924957000136",
// "9014776000135",
// "9026590000104",
// "9141112000137",
// "9185272000188",
// "9213837000193",
// "9325966000173",
// "9555406000105",
// "9581854000183",
// "9600312000100",
// "10266430000103",
// "10281344000170",
// "10325861000101",
// "10339187000378",
// "10508173000179",
// "10533047000174",
// "10533819000178",
// "10540757000121",
// "10726245000154",
// "10770822000105",
// "10853493000166",
// "10958729000129",
// "11141425000137",
// "11392761000152",
// "11503123000161",
// "11693937000106",
// "11733246000199",
// "11816237000161",
// "12106923000101",
// "12123946000124",
// "12158113000107",
// "12185414000111",
// "12299891000108",
// "12437907000100",
// "12910797000143",
// "12951790000170",
// "13096858000143",
// "13282387000168",
// "13607784000162",
// "13769448000116",
// "13924222000142",
// "14169952000148",
// "14267494000180",
// "14505201000155",
// "14573834000109",
// "14760601000107",
// "14962699000185",
// "15041721000206",
// "15334239000175",
// "16417683000117",
// "16422286000133",
// "16616043000136",
// "16675331000161",
// "16917226000191",
// "16957746000985",
// "17256517000149",
// "17290672000181",
// "17622342000146",
// "18208391000108",
// "18418465000122",
// "18418471000180",
// "18539880000134",
// "19010664000160",
// "19097379000128",
// "19516302000145",
// "19900303000270",
// "20115766000129",
// "20158501000108",
// "20472211000134",
// "20759766000161",
// "21051524000181",
// "21227519000187",
// "21232255000150",
// "21497798000107",
// "21897835000166",
// "21924609000127",
// "21954622000129",
// "22080811000182",
// "22193083000115",
// "22240318000182",
// "22457001000100",
// "22850701000152",
// "22934207000176",
// "22992264000101",
// "23165024000104",
// "23433119000153",
// "23595772000119",
// "23623799000178",
// "23659259000144",
// "23847885000164",
// "23937218000172",
// "23988465000106",
// "24446580000103",
// "24524267000146",
// "24764974000100",
// "24860379000178",
// "24941263000163",
// "24959000000181",
// "25070674000193",
// "25182702000164",
// "25448296000139",
// "26174065000147",
// "26536531000197",
// "26590610000186",
// "26728924000100",
// "26775586000150",
// "26842032000128",
// "26987189000141",
// "27037554000110",
// "27360738000116",
// "27526347000129",
// "27549318000182",
// "27566901000100",
// "27584079000100",
// "27634768000173",
// "27816627000171",
// "28050069000149",
// "28189226000100",
// "28459730000174",
// "28496927000183",
// "28558638000161",
// "28653233000102",
// "28720926000170",
// "28747490000103",
// "28863332000119",
// "29036323000117",
// "29084242000192",
// "29274200000114",
// "29287461000179",
// "29677928000197",
// "29940049000106",
// "30158200000138",
// "30188844000179",
// "30246754000197",
// "30331909000193",
// "30393702000143",
// "30570554000195",
// "30574963000160",
// "30604238000197",
// "30727017000106",
// "30998254003046",
// "31070443000182",
// "31324060000193",
// "31509347000198",
// "31796706000135",
// "31806076000132",
// "31914566000152",
// "31952267000102",
// "32147281000104",
// "32168764000187",
// "32243238000134",
// "32292347000141",
// "32494101000152",
// "32717483000136",
// "32739652000139",
// "32752492000168",
// "32752534000160",
// "32970415000184",
// "33066334000117",
// "33171852000109",
// "33196417000120",
// "33246116000164",
// "33337873000143",
// "33581741000162",
// "33694827000100",
// "33699236000117",
// "33723398000143",
// "33828579000134",
// "34007934000177",
// "34010531000187",
// "34266549000144",
// "34312674000143",
// "34413966000172",
// "34496031000105",
// "34547288000130",
// "34630865000153",
// "34703159000194",
// "34717633000137",
// "34724873000169",
// "34854324000109",
// "34895960000189",
// "34966062000174",
// "35000878000101",
// "35101599000134",
// "35310892000101",
// "35429199000152",
// "35445202000121",
// "35616536000110",
// "35789336000160",
// "35793054000136",
// "35829274000687",
// "35927781000149",
// "35987637000106",
// "36358344000114",
// "36387605000124",
// "36697626000146",
// "36705831000106",
// "36980271000106",
// "37086708000117",
// "37299858000109",
// "37313949000151",
// "37467886000198",
// "37721810000147",
// "37724578000109",
// "37753351000183",
// "37801175000108",
// "37858997000125",
// "38221994000149",
// "38223578000180",
// "38356634000154",
// "38653407000190",
// "38824899000130",
// "38860928000119",
// "39148045000143",
// "39357873000191",
// "39418103000101",
// "39432394000192",
// "39504925000105",
// "39676102000167",
// "39898053000107",
// "39937437000191",
// "40026859000194",
// "40064026000118",
// "40090492000178",
// "40248314000122",
// "40285014000113",
// "40388263000134",
// "40389269000126",
// "40426533000154",
// "40673009000188",
// "40779261000176",
// "40807686000141",
// "40935657000165",
// "41020107000189",
// "41031747000194",
// "41204873000101",
// "41228737000143",
// "41247657000135",
// "41290936000181",
// "41315747000116",
// "41343698000125",
// "41350920000117",
// "41413049000153",
// "41486776000140",
// "41601657000191",
// "41609492000102",
// "41683187000152",
// "41760104000181",
// "41779044000149",
// "41820750000197",
// "41836790000127",
// "41928020000104",
// "42209755000140",
// "42315001000175",
// "42425250000113",
// "42479777000120",
// "42900824000168",
// "43172182000190",
// "43214310000111",
// "43419425000142",
// "43478647000136",
// "43665208000132",
// "43797062000189",
// "43937660000106",
// "43962700000170",
// "44034790000100",
// "44082992000119",
// "44126861000196",
// "44150102000169",
// "44259545000192",
// "44327236000102",
// "44367098000195",
// "44377967000162",
// "44556395000189",
// "44624347000180",
// "44781105000109",
// "44941998000102",
// "44994019000176",
// "45301501000146",
// "45399915000150",
// "45571975000108",
// "45648210000129",
// "45802349000185",
// "46236757000180",
// "46718879000102",
// "47007011000167",
// "47040250000119",
// "47558387000160",
// "47695393000169",
// "48348863000180",
// "48532815000148",
// "74009606000124",
// "87541959000112",
// "87550422000119",
// "87951000000155",
// "87958625000149",
// "88011689000281",
// "88784137000125",
// "88921119000148",
// "89215586000115",
// "89218879000156",
// "89639751000247",
// "89992861000107",
// "90031170000126",
// "90041724000176",
// "90232380000182",
// "90374059000132",
// "90503020000178",
// "90509027000105",
// "90568015000143",
// "90682923000163",
// "90704420000141",
// "90955048000146",
// "91387159000166",
// "91642249000156",
// "91791582000127",
// "91833061000195",
// "91919027000138",
// "92220268000157",
// "92781392000191",
// "92881754000116",
// "93112282000108",
// "93233799000147",
// "93334613000146",
// "93367373000186",
// "93545093000110",
// "93771897000138",
// "93963643000111",
// "94306008000124",
// "94313137000140",
// "94384930000130",
// "94564796000230",
// "94689155000120",
// "94785706000150",
// "94836707000186",
// "95188660000154",
// "21483500000100",
// "14246305000192",
// "45876894000116",
// "88979752000197",
// "6974882000172",
// ]

const formattedCnpjs = listCnpj.map(cnpj => {
  // Verifica se o CNPJ tem menos de 14 dígitos
  if (cnpj.length < 14) {
    // Calcula a quantidade de zeros necessários
    const zerosToAdd = 14 - cnpj.length;
    // Adiciona os zeros à esquerda
    const formattedCnpj = "0".repeat(zerosToAdd) + cnpj;
    return formattedCnpj;
  } else {
    // Retorna o CNPJ sem alterações, pois já tem 14 dígitos
    return cnpj;
  }
});

const fetch = require('node-fetch');
const ExcelJS = require('exceljs');


function fetchCnpjData(cnpj) {
  let url = `https://api.exato.digital/receita-federal-sintegra/cnpj-sintegra?token=1e11dd8dc5944efabed5a93b2f1b1a12&cnpj=${cnpj}&format=json`;

  return fetch(url)
    .then((response) => response.json())
    .then((responseJson) => responseJson.Result.Sintegra)
    .catch((error) => {
      console.error(`Erro para o CNPJ ${cnpj}:`, error);
      return null;
    });
}

async function fetchDataWithDelay() {
  const workbook = new ExcelJS.Workbook();
  const worksheet = workbook.addWorksheet('Receita Federal CNPJs');
  
  for (const cnpj of formattedCnpjs) {
    const receitaFederalCnpj = await fetchCnpjData(cnpj);

    if (receitaFederalCnpj && receitaFederalCnpj.CNPJ) {
      // Adicione os dados à planilha
      
      worksheet.addRow([
        receitaFederalCnpj.CNPJ,
        receitaFederalCnpj.RazaoSocial,
        receitaFederalCnpj.SituacaoCadastralAtual
      ]);
      console.log(`Dados adicionados à planilha para o CNPJ ${cnpj}`);
    } else {
      worksheet.addRow([`Nenhum dado disponível para o CNPJ`, cnpj]);
      console.log(`Nenhum dado disponível para o CNPJ ${cnpj}`);
    }

    // Aguarda 5 segundos antes da próxima iteração
    await new Promise((resolve) => setTimeout(resolve, 100));
  }
  await workbook.xlsx.writeFile('output.xlsx');
}

// Chamada da função assíncrona
fetchDataWithDelay();